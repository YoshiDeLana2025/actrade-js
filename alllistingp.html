<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Animal Crossing Code Project — All item list+</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="./data/css/styles.css" />
</head>
<body>
  <header>
    <h1>All item list+</h1>
    <p>All known items + notes. Glitches/nothing markers and special notes are shown where available.</p>
  </header>
  <main>
    <label>Search: <input id="search" placeholder="Search name or hex (0x....)" /></label>
    <table id="items-table" width="90%" bgcolor="#CECECE">
      <thead style="background:#EAEAEA;">
        <tr><th>Item number (dec)</th><th>Item number (hex)</th><th>Description</th><th>Notes</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </main>

  <script src="./data/js/items.js"></script>
  <script src="./data/js/nothinglist.js"></script>
  <script src="./data/js/glitchlist.js"></script>
  <script src="./data/js/speciallist.js"></script>
  <script src="./data/js/app.js" type="module"></script>
  <script>
    const tableBody = document.querySelector('#items-table tbody');
    const searchInput = document.getElementById('search');

    function hexToDec(h) { return parseInt(h, 16); }

    function makeNotesForKey(hexKey) {
      const notes = [];
      const upKey = hexKey.toUpperCase();
      if (window.AC_GLITCH && window.AC_GLITCH[upKey]) {
        notes.push(`<span class="note-glitch">Glitch: ${window.AC_GLITCH[upKey]}</span>`);
      }
      if (window.AC_NOTHING && window.AC_NOTHING[upKey]) {
        notes.push(`<span class="note-nothing">Nothing</span>`);
      }
      if (window.AC_SPECIAL && window.AC_SPECIAL[upKey]) {
        notes.push(`<span class="note-special">${window.AC_SPECIAL[upKey]}</span>`);
      }
      return notes.join(' — ');
    }

    function render() {
      const q = (searchInput.value || '').trim().toLowerCase();
      const entries = Object.keys(window.AC_ITEMS || {}).map(k => ({k, v: window.AC_ITEMS[k]}));
      entries.sort((a,b) => hexToDec(a.k) - hexToDec(b.k));
      tableBody.innerHTML = '';
      for (const e of entries) {
        if (q) {
          if (!(e.k.toLowerCase().includes(q) || (e.v && e.v.toLowerCase().includes(q)))) continue;
        }
        const tr = document.createElement('tr');
        tr.style.background = '#FFFFFF';
        const dec = hexToDec(e.k);
        const notesHtml = makeNotesForKey(e.k) || '&nbsp;';
        tr.innerHTML = `<td>${dec}</td><td>${e.k}</td><td>${e.v}</td><td>${notesHtml}</td>`;
        tableBody.appendChild(tr);
      }
    }

    searchInput.addEventListener('input', render);
    document.addEventListener('DOMContentLoaded', render);
  </script>
</body>
</html>
